diff -up openssl-1.0.2k/crypto/x509/x509_cmp.c.null-hash-deref openssl-1.0.2k/crypto/x509/x509_cmp.c
--- openssl-1.0.2k/crypto/x509/x509_cmp.c.null-hash-deref	2021-09-01 14:13:51.247986607 +0200
+++ openssl-1.0.2k/crypto/x509/x509_cmp.c	2021-09-01 14:15:13.542078900 +0200
@@ -88,6 +88,8 @@ unsigned long X509_issuer_and_serial_has
     EVP_MD_CTX_init(&ctx);
     EVP_MD_CTX_set_flags(&ctx, EVP_MD_CTX_FLAG_NON_FIPS_ALLOW);
     f = X509_NAME_oneline(a->cert_info->issuer, NULL, 0);
+    if (f == NULL)
+        goto err;
     if (!EVP_DigestInit_ex(&ctx, EVP_md5(), NULL))
         goto err;
     if (!EVP_DigestUpdate(&ctx, (unsigned char *)f, strlen(f)))
